<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Shakzz TV</title>
  
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/x-icon" href="Jinwoo.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="style.css"> 

  <script src="https://ssl.p.jwpcdn.com/player/v/8.38.10/jwplayer.js"></script>
  <script>jwplayer.key = "ITWMv7t88JGzI0xPwW8I0+LveiXX9SWbfdmt0ArUSyc="</script>
</head>

<body>

  <div id="preloader">
      <div class="loader-content">
          <img src="logo.png" alt="Loading..." class="loader-logo" onerror="this.style.display='none'">
          <div class="spinner"></div>
          <p>Feel Free To Watch!</p>
      </div>
  </div>

  <div class="sidebar" id="main-sidebar">
      <div class="sidebar-header">
          <img src="logo.png" alt="Shakzz TV" class="sidebar-logo" onerror="this.style.display='none'">
          <span class="logo-text">SHAKZZ<span style="color:#e50914;">TV</span></span>
          <span class="close-sidebar" onclick="toggleSidebar()">×</span>
      </div>
      <div class="sidebar-menu">
          <a href="#" onclick="switchView('home')" class="active"><i class="fa-solid fa-house"></i> Home</a>
          <a href="#" onclick="openSearchModal()"><i class="fa-regular fa-compass"></i> Explore</a>
          <a href="#" onclick="switchView('live')"><i class="fa-solid fa-tv"></i> Live TV</a>
          <a href="#" onclick="openInfoModal('updates')"><i class="fa-solid fa-bell"></i> Updates</a>
          <a href="#" onclick="openInfoModal('contact')"><i class="fa-solid fa-envelope"></i> Contact</a>
      </div>
      <div class="sidebar-footer">
          <p>Shakzz TV © 2025</p>
      </div>
  </div>
  <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

  <div class="navbar">
    <div class="nav-left">
        <div class="hamburger" onclick="toggleSidebar()"><i class="fa-solid fa-bars"></i></div>
        <div class="logo-text">SHAKZZ<span style="color:#e50914;">TV</span></div>
    </div>
    <div class="nav-right">
        <div id="viewerCounter" class="view-count" style="margin-right: 10px; color: #e50914; font-weight: bold; font-size: 0.9rem;">
            <i class="fa fa-eye"></i> <span id="live-counter">...</span>
        </div>
        
        <div class="search-trigger" onclick="openSearchModal()"><i class="fa-solid fa-magnifying-glass"></i></div>
        
        <div class="auth-wrapper">
            <div id="logged-out-state">
                <button class="login-btn" onclick="toggleAuthDropdown('login')">
                    <i class="fa-regular fa-user"></i> <span>Sign In</span>
                </button>
                <div class="auth-dropdown" id="login-dropdown">
                    <div class="dropdown-header">Sign in to save your watch history.</div>
                    
                    <div class="social-item" onclick="loginGoogle()">
                        <i class="fa-brands fa-google" style="color:#DB4437;"></i> Google
                    </div>
                    <div class="social-item" onclick="loginGithub()">
                        <i class="fa-brands fa-github" style="color:#fff;"></i> Github
                    </div>

                    <div style="border-top: 1px solid #333; margin: 5px 0;"></div>
                    <div class="dropdown-footer" style="font-size: 0.8rem; color: #aaa; text-align: center; padding: 5px;">
                        More coming soon...
                    </div>
                </div>
            </div>

            <div id="logged-in-state" style="display:none;">
                <img src="https://i.pinimg.com/736x/8b/16/7a/8b167af653c2399dd93b952a48740620.jpg" alt="Profile" class="nav-avatar" onclick="toggleAuthDropdown('profile')">
                <div class="auth-dropdown" id="profile-dropdown">
                    <div class="user-info-box">
                        <img src="https://i.pinimg.com/736x/8b/16/7a/8b167af653c2399dd93b952a48740620.jpg" class="menu-avatar">
                        <div class="user-text">
                            <span class="user-name">User</span>
                        </div>
                    </div>
                    <div class="dropdown-divider"></div>
                    <div class="menu-item"><i class="fa-solid fa-clock-rotate-left"></i> History list</div>
                    <div class="menu-item"><i class="fa-regular fa-heart"></i> Favorite list</div>
                    <div class="menu-item logout" onclick="doLogout()"><i class="fa-solid fa-power-off"></i> Sign out</div>
                </div>
            </div>
        </div>
    </div>
  </div>

  <div id="home-view">
      <div class="slider-viewport">
        <div class="slider-track" id="slider-track"></div>
        <div class="slider-dots" id="slider-dots"></div>
      </div>

      <div class="row" id="continue-watching-row" style="display: none;">
        <h2><span class="section-indicator" style="background: #e50914;"></span> Continue Watching <i class="fa-solid fa-clock-rotate-left"></i></h2>
        <div class="list" id="continue-list"></div>
      </div>

      <div class="row"><h2 onclick="openCategory('airing_today', 'Latest Updates')"><span class="section-indicator"></span> Latest Updates <i class="fa-solid fa-chevron-right"></i></h2><div class="list" id="latest-list"></div></div>
      <div class="row"><h2 onclick="openCategory('kdrama', 'Top K-Drama')"><span class="section-indicator"></span> Top K-Drama <i class="fa-solid fa-chevron-right"></i></h2><div class="list" id="kdrama-list"></div></div>
      <div class="row"><h2 onclick="openCategory('cdrama', 'Top C-Drama')"><span class="section-indicator"></span> Top C-Drama <i class="fa-solid fa-chevron-right"></i></h2><div class="list" id="cdrama-list"></div></div>
      <div class="row"><h2 onclick="openCategory('movie', 'Trending Movies')"><span class="section-indicator"></span> Trending Movies <i class="fa-solid fa-chevron-right"></i></h2><div class="list" id="movies-list"></div></div>
      <div class="row"><h2 onclick="openCategory('tv', 'Trending TV Shows')"><span class="section-indicator"></span> Trending TV Shows <i class="fa-solid fa-chevron-right"></i></h2><div class="list" id="tvshows-list"></div></div>
      <div class="row"><h2 onclick="openCategory('anime', 'Trending Anime')"><span class="section-indicator"></span> Trending Anime <i class="fa-solid fa-chevron-right"></i></h2><div class="list" id="anime-list"></div></div>
      <div class="row"><h2 onclick="openCategory('upcoming', 'Upcoming Releases')"><span class="section-indicator"></span> Upcoming <i class="fa-solid fa-chevron-right"></i></h2><div class="list" id="upcoming-list"></div></div>

      <footer class="footer">
        <div class="footer-links">
          <a href="#" onclick="openInfoModal('dmca')">Disclaimer</a>
          <a href="#" onclick="openInfoModal('privacy')">Privacy</a>
        </div>
        <p>© 2025 Shakzz TV.</p>
      </footer>
  </div>

  <div id="live-view" style="display: none;">
      <div class="live-player-container">
            <div id="playerWrapper">
                <div id="video">
                    <div class="skeleton" style="width: 100%; height: 100%; position: absolute; top: 0; left: 0; background: #000;"></div>
                </div>
                <div id="overlayContainer">
                    <div id="nowPlayingOverlay">
                        <span class="pulsing-dot"></span>
                        Now Playing: <span id="nowPlayingChannel">--</span>
                    </div>
                </div>
            </div>
      </div>
      <div class="channel-section">
            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="live-search-input" placeholder="Search channel..." class="focusable-element" oninput="filterChannels()">
                <i class="fas fa-times clear-btn" id="live-clear-btn" style="display:none;" onclick="clearLiveSearch()"></i>
            </div>
            <div class="category-bar"></div>
            <button id="mobileCategoryBtn" class="category-dropdown-btn focusable-element">
                <span>All Categories</span>
                <i class="fas fa-chevron-down"></i>
            </button>
            <div id="animeSeriesContainer" class="anime-selector-container" style="display: none;">
                <select id="animeSeriesSelect" class="focusable-element">
                    <option value="" disabled selected>Select Anime Title</option>
                </select>
            </div>
            <div id="clearFavWrapper" style="display:none; margin-bottom: 10px;">
                 <button id="clearFavoritesBtn" class="clear-fav-btn">
                    <i class="fas fa-trash"></i> Clear Favorites
                </button>
            </div>
            <div class="channel-count-display">
                <i class="fas fa-tv"></i>
                <span id="channelCountText">Loading...</span>
            </div>
            <div class="channel-list-wrapper">
                <div class="channel-list" id="channelList"></div>
            </div>
      </div>
  </div>

  <div id="detail-view" class="detail-view">
      <div class="detail-video-container">
      <div id="detail-poster-section" class="detail-poster-section">
    <img id="detail-poster-img">
    <div class="poster-overlay"></div>

    <div class="poster-actions">
        <button class="play-main-btn" onclick="startPlayback()">
            <i class="fa-solid fa-play"></i> Play
        </button>

        <button class="fav-main-btn" onclick="toggleDetailFavorite(this)">
            <i class="fa-regular fa-heart"></i> Watchlist
        </button>
    </div>
</div>

        <div id="video-cover" class="video-cover" onclick="hideVideoCover()">
    <img id="video-cover-img" src="" alt="Cover">
    <div class="play-icon">
        <i class="fa-solid fa-play"></i>
    </div>
</div>

          <iframe id="detail-video" allowfullscreen></iframe>
          <div class="detail-close" onclick="closeDetailView()"><i class="fa-solid fa-chevron-down"></i></div>
      </div>
      <div class="detail-content">
          <div class="detail-header-group">
            <h1 id="detail-title">Title Here</h1>
            <div class="detail-meta">
                <span class="badge" id="detail-date">2025</span>
                <span class="badge">HD</span>
                <span class="badge" id="detail-lang">EN</span>
            </div>
          </div>
          <div class="detail-desc">
              <p id="detail-overview">...</p>
          </div>
          <div class="server-select-container">
               <label>Source:</label>
                 <div class="sandbox-toggle-wrapper">
        <label class="switch">
            <input type="checkbox" id="sandbox-toggle" checked onchange="toggleSandbox()">
            <span class="slider round"></span>
        </label>
        <span>Block Ads (Turn off if video fails)</span>
    </div>
               <select id="detail-server" onchange="changeDetailServer()">
                   <option value="vidsrc.to">Server 1 (VidSrc)</option>
                   <option value="vidsrc.me">Server 2 (Me)</option>
                   <option value="vidlink.pro">Server 3 (VidLink)</option>
                   <option value="superembed.stream">Server 4 (Super)</option>
                   <option value="2embed.cc">Server 5 (2Embed)</option>
                   <option value="vidsrc.cc">Server 6 (CC)</option>
                   <option value="vidsrc.xyz">Server 7 (XYZ)</option>
                   <option value="vidsrc.vip">Server 8 (VIP)</option>
                   <option value="vidsrc.net">Server 9 (Net)</option>
               </select>
          </div>
          <div class="action-bar">
              <div class="action-item" onclick="toggleDetailFavorite(this)"><i class="fa-regular fa-heart"></i><span>Favorite</span></div>
              <div class="action-item" onclick="shareContent()"><i class="fa-solid fa-share-nodes"></i><span>Share</span></div>
              <div class="action-item" onclick="downloadContent()"><i class="fa-solid fa-download"></i><span>Download</span></div>
          </div>
          <div class="episode-section">
              <div class="episode-filters" style="display:none;"> 
                  <select id="season-select" onchange="onSeasonChange()"></select>
                  <select id="range-select" onchange="renderEpisodes()"></select>
              </div>
              <div class="episode-grid" id="episode-grid"></div>
          </div>
      </div>
  </div>

  <div id="category-view" class="category-view">
      <div class="category-header">
          <i class="fa-solid fa-arrow-left" onclick="closeCategory()"></i>
          <h1 id="category-title">Category</h1>
      </div>
      <div class="category-content" id="category-content">
          <div class="category-grid" id="category-grid"></div>
      </div>
  </div>

  <div id="categoryModal" class="modal-overlay">
      <div class="modal-content category-modal-content">
          <span class="close-button" id="closeCategoryModal">×</span>
          <h3 class="modal-heading">Select Category</h3>
          <div id="mobileCategoryList" class="mobile-category-list"></div>
      </div>
  </div>

  <div id="info-modal" class="info-modal">
      <div class="info-content-wrapper">
          <div class="info-header">
              <h2 id="info-title">Page Title</h2>
              <span class="close-info" onclick="closeInfoModal()">×</span>
          </div>
          <div class="info-body" id="info-body"></div>
      </div>
  </div>

  <div class="search-modal" id="search-modal">
    <div class="search-header-row">
        <i class="fa-solid fa-arrow-left search-back-btn" onclick="closeSearchModal()"></i>
        <div class="search-bar-wrapper">
            <i class="fas fa-search search-modal-icon"></i>
            <input type="text" id="search-input" placeholder="Search..." oninput="handleSearchInput()" />
            <i class="fas fa-times search-clear-btn" id="search-clear-btn" onclick="clearSearchInput()"></i>
        </div>
    </div>
    <div class="search-filters">
        <button class="filter-pill active" onclick="setSearchFilter('all', this)">All</button>
        <button class="filter-pill" onclick="setSearchFilter('tv', this)">TV Series</button>
        <button class="filter-pill" onclick="setSearchFilter('movie', this)">Movies</button>
        <button class="filter-pill" onclick="setSearchFilter('anime', this)">Anime</button>
        <button class="filter-pill" onclick="setSearchFilter('kdrama', this)">K-Drama</button>
        <button class="filter-pill" onclick="setSearchFilter('cdrama', this)">C-Drama</button>
    </div>
    <div class="results-container">
        <h3 id="search-heading">Popular Search</h3>
        <div class="results" id="search-results"></div>
    </div>
  </div>

  <script src="channels.js"></script>
  <script src="script.js"></script>
  <script type="module" src="auth.js"></script>

  <script>
      function switchView(viewName) {
          const home = document.getElementById('home-view');
          const live = document.getElementById('live-view');
          const sidebar = document.getElementById('main-sidebar');
          const overlay = document.getElementById('overlay');
          
          if(viewName === 'live') {
              home.style.display = 'none';
              live.style.display = 'flex'; 
              if(window.innerWidth < 1024) live.style.flexDirection = 'column';
              if(window.jwplayer) { try { jwplayer().resize(); } catch(e){} }
          } else {
              home.style.display = 'block';
              live.style.display = 'none';
              if(window.jwplayer) { try { jwplayer().stop(); } catch(e){} }
          }
          if(window.innerWidth < 1024) {
              sidebar.classList.remove('open');
              overlay.classList.remove('active');
          }
      }
      
      let userId = localStorage.getItem('visitor_uid') || Math.random().toString(36).substring(7);
      localStorage.setItem('visitor_uid', userId);
      async function updateOnlineCount() {
        try {
          const response = await fetch(`/api/visit?uid=${userId}&t=${Date.now()}`);
          if (response.ok) {
            const data = await response.json();
            document.getElementById('live-counter').innerText = data.count.toLocaleString();
          }
        } catch (err) {}
      }
      setInterval(updateOnlineCount, 5000);
      updateOnlineCount();
  </script>

</body>
</html>